import{d as I,u as K,g as y,h as H,E as J,r as d,i as Q,c as m,b as n,w as s,j as R,F as v,L as W,o as l,k as w,l as r,a as i,m as V,n as S,t as g,S as X,q as Y,M as k,T as D}from"./index-8a7c54d3.js";import{_ as Z}from"./AddButton.vue_vue_type_script_setup_true_lang-1faad7b7.js";import{_ as ee}from"./LockButton.vue_vue_type_style_index_0_lang-d0e7d944.js";import{u as te}from"./subscriptions-39161759.js";import{_ as ae}from"./DeleteButton.vue_vue_type_script_setup_true_lang-33d37ec2.js";import"./customers-533e8710.js";const ne={key:0},oe={key:0,class:"border-round border-1 surface-border p-4 surface-card"},se={class:"grid p-fluid"},re={class:"field col-12 md:col-6 lg:col-4"},ie={class:"p-float-label"},de={class:"flex justify-content-between mt-3"},le={class:"p-paginator-pages"},ce=i("div",{class:"grid p-fluid"},[i("div",{class:"field col-12 md:col-6 lg:col-4"})],-1),ue=i("div",{class:"no-data-message",style:{height:"100px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",padding:"20px","background-color":"#f9f9f9","border-radius":"5px","box-shadow":"0 2px 4px rgba(0, 0, 0, 0.1)"}},[i("p",{style:{"font-size":"18px","font-weight":"bold",color:"#888"}}," لا يوجد بيانات ")],-1),me={key:0},ve=I({__name:"SubscriptionsRecord",setup(pe){const t=te(),f=K(),_=y({global:{value:null,matchMode:W.CONTAINS}}),P=y([{field:"serviceName",header:"الباقه"}]),F=y(P.value);H(()=>{t.getSubs()});const x=a=>k(a).format("yy/M/D  hh:mm a"),L=a=>{switch(B(a)){case" مفعل":return"success";case" غير مفعل":return"danger";case" مقفل":return"danger"}},M=a=>{if(a===1)return" مفعل";if(a===2)return" غير مفعل";if(a===5)return" مقفل"},B=a=>{if(a=="1")return" مفعل";if(a=="2")return" غير مفعل";if(a=="5")return" مقفل"},C=a=>{const o=k(),u=k(a).diff(o,"days");return u<=0?{label:"منتهي",color:"red"}:u<=30?{label:"قريباً من الانتهاء",color:"orange"}:{label:"صالح",color:"green"}};J(_,a=>{t.currentPage=1,t.pageNumber=1,t.getSubs()});const $=()=>{t.currentPage<t.totalPages&&(t.currentPage+=1,t.pageNumber+=1,t.loading=!0,t.getSubs())},z=()=>{t.currentPage>1&&(t.currentPage-=1,t.pageNumber-=1,t.loading=!0,t.getSubs())},j=async a=>{try{let o;a.status==1&&(o=await D.block(a.id)),a.status==2&&(o=await D.unblock(a.id)),f.add({severity:"success",summary:"نجحة العملية",detail:o==null?void 0:o.data.msg,life:3e3}),t.getSubs()}catch(o){f.add({severity:"error",summary:"حدث خطأ",detail:o.response.data.msg||"حدث خطأ",life:3e3})}},O=a=>{D.remove(a).then(o=>{f.add({severity:"success",summary:"تم الحذف",detail:o.data.msg,life:3e3}),t.getSubs()}).catch(o=>{f.add({severity:"error",summary:"رسالة خطأ",detail:o.response.data.msg,life:3e3})})};return(a,o)=>{const N=d("RouterView"),u=d("Skeleton"),h=d("Button"),c=d("Column"),T=d("Tag"),U=d("Dropdown"),A=d("RouterLink"),E=d("DataTable"),G=d("Card"),q=Q("tooltip");return l(),m(v,null,[n(N),a.$route.path==="/subscriptionsRecord"?(l(),m("div",ne,[n(G,null,{title:s(()=>[w(" سجل الاشتراكات "),n(Z,{"name-button":"إضافة اشتراك","rout-name":"/subscriptionsRecord/addSubsciptions"})]),content:s(()=>[r(t).loading?(l(),m("div",oe,[i("div",se,[(l(),m(v,null,V(9,e=>i("div",re,[i("span",ie,[n(u,{width:"100%",height:"2rem"})])])),64))]),n(u,{width:"100%",height:"100px"}),i("div",de,[n(u,{width:"100%",height:"2rem"})])])):(l(),S(E,{key:1,ref:"dt",value:r(t).subscriptions,dataKey:"id",paginator:!0,rows:10,filters:_.value,"onUpdate:filters":o[0]||(o[0]=e=>_.value=e),globalFilterFields:["serviceName","customerName"],rowsPerPageOptions:[5,10,25],pageLinkSize:r(t).totalPages,currentPage:r(t).currentPage-1,paginatorTemplate:"  "},{paginatorstart:s(()=>[n(h,{icon:"pi pi-angle-right",class:"p-button-rounded p-button-primary p-paginator-element",disabled:r(t).currentPage===1,onClick:z},null,8,["disabled"]),i("span",le," الصفحة "+g(r(t).currentPage)+" من "+g(r(t).totalPages),1)]),paginatorend:s(()=>[n(h,{icon:"pi pi-angle-left",class:"p-button-rounded p-button-primary p-paginator-element",disabled:r(t).currentPage===r(t).totalPages,onClick:$},null,8,["disabled"])]),header:s(()=>[ce]),empty:s(()=>[ue]),default:s(()=>[n(c,{field:"customerName",header:"اسم العميل",style:{"min-width":"6rem"},class:"font-bold"}),n(c,{field:"status",header:"  الحاله ",filterField:"status",style:{width:"6rem"},showFilterMenu:!1,filterMenuStyle:{width:"12rem"}},{body:s(({data:e})=>[n(T,{value:M(e.status),severity:L(e.status)},null,8,["value","severity"])]),filter:s(({filterModel:e,filterCallback:b})=>[n(U,{modelValue:e.value,"onUpdate:modelValue":p=>e.value=p,onChange:p=>b(),options:["warning",""],placeholder:"Select One",class:"p-column-filter",style:{"min-width":"12rem"},showClear:!0},{option:s(p=>[n(T,{value:p.option,severity:p.option},null,8,["value","severity"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),(l(!0),m(v,null,V(F.value,(e,b)=>(l(),S(c,{field:e.field,header:e.header,key:e.field+"_"+b,style:{"min-width":"3rem"}},null,8,["field","header"]))),128)),n(c,{field:"daysRemaining",header:"الصلاحية",style:{"min-width":"4rem"}},{body:s(({data:e})=>[i("span",{style:X({color:C(e.endDate).color})},g(C(e.endDate).label),5)]),_:1}),n(c,{field:"startDate",header:"تاريخ بداية الاشتراك",dataType:"date",style:{"min-width":"11rem"}},{body:s(({data:e})=>[w(g(x(e.startDate)),1)]),_:1}),n(c,{field:"endDate",header:"تاريخ نهاية الاشتراك",dataType:"date",style:{"min-width":"11rem"}},{body:s(({data:e})=>[w(g(x(e.endDate)),1)]),_:1}),n(c,{style:{"min-width":"11rem"}},{body:s(e=>[e.data.status!==5?(l(),m("span",me,[n(ae,{name:e.data.id,id:e.data.id,onSubmit:()=>O(e.data.id),type:"Subscription"},null,8,["name","id","onSubmit"])])):R("",!0),n(ee,{typeLock:"Subscriptions",id:e.data.id,name:e.data.id,status:e.data.status,onSubmit:()=>j(e.data),onGetdata:r(t).getSubs},null,8,["id","name","status","onSubmit","onGetdata"]),(l(),S(A,{key:e.data.id,to:"/subscriptionsRecord/SubscriptionsDetaView/"+e.data.id,style:{"text-decoration":"none"}},{default:s(()=>[Y(n(h,{icon:"fa-solid fa-circle-info",severity:"info",text:"",rounded:""},null,512),[[q,{value:"التفاصيل",fitContent:!0}]])]),_:2},1032,["to"]))]),_:1})]),_:1},8,["value","filters","pageLinkSize","currentPage"]))]),_:1})])):R("",!0)],64)}}});export{ve as default};
