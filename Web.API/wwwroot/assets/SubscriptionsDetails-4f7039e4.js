import{_ as Y}from"./BackButton.vue_vue_type_script_setup_true_lang-3994efeb.js";import{d as j,g as f,h as E,o as n,c as l,a as e,S as Z,t as d,V as ee,_ as te,u as se,D as oe,s as ne,v as ie,T as V,M as A,r as b,i as ae,n as D,w as x,k as R,b as i,j as B,F as T,m as z,q as le,f as ce}from"./index-8a7c54d3.js";import{u as re}from"./subscriptions-39161759.js";import{s as de}from"./service-6188a30c.js";import{v as ue}from"./visits-35c089e4.js";const _e={class:"progress"},ve={class:"bar-overflow"},me=j({__name:"CircularProgressBar",props:["percentage"],setup($){const{percentage:c}=$,u=f(0),k=f(""),h=f("");E(()=>{p()});const p=()=>{const v=c,w=120;let g=0;const s=setInterval(()=>{if(g>=w)clearInterval(s);else{const P=_(g/w);g+=1;const S=Math.round(P*v);u.value=S;const I=45+S*.49;k.value=`transform: rotate(${I}deg);`,u.value<=30?h.value="border-bottom-color: red; border-right-color: red;":h.value="border-bottom-color: navy; border-right-color: navy;"}},25)};function _(v){return v<.5?2*v*v:-1+(4-2*v)*v}return(v,w)=>(n(),l("div",_e,[e("div",ve,[e("div",{class:"bar",style:Z([k.value,h.value])},null,4)]),e("span",{class:ee(["percentage-text",{"red-text":u.value<=30}])},d(u.value),3)]))}});const pe=te(me,[["__scopeId","data-v-1c8c1848"]]),fe={key:0},he=e("div",{class:"warning-message"},[e("div",{class:"warning-message-icon"}),e("div",{class:"warning-message-text"}," هذه الخدمة مقفلة لا يمكن تجديدها او اضافة شيء عليها ")],-1),ge=[he],ye={class:"grid p-fluid"},be={key:0},xe={class:"grid p-fluid"},ke={key:1,class:"flex-1",style:{"text-align":"center",width:"20rem"}},we={style:{display:"inline-block"}},Ce=e("h2",null,"الأيام المتبقية",-1),De={key:0},Re=e("h3",{class:"text-red-600"},"هذا الاشتراك قارب على الانتهاء",-1),Pe={key:0},Se=e("h5",{class:"text-red-600",style:{"margin-bottom":"5px"}}," اضغط على الأيقونة للتجديد ",-1),Ne={key:1},Be=e("h3",{class:"text-red-600"},"هذا الاشتراك انتهى",-1),Ie=e("h5",{class:"text-red-600",style:{"margin-bottom":"5px"}}," اضغط على الأيقونة للتجديد ",-1),Fe={key:2},Ve=e("h3",{class:"text-red-600"},"هذا الاشتراك انتهى",-1),$e=e("h5",{class:"text-red-600",style:{"margin-bottom":"5px"}}," اضغط على الأيقونة للتجديد ",-1),Oe=e("div",{class:"confirmation-content"},[e("i",{class:"fa-solid fa-repeat mr-3",style:{color:"green"}}),e("span",null,"هل انت متأكد من تجديد الاشتراك؟")],-1),Le={class:"grid p-fluid"},Ue={class:"field col-4 md:col-4 lg:col-6"},Ae={class:"file-input-label",for:"fileInput"},Te={class:"file-input-content"},ze=e("div",{class:"file-input-icon"},null,-1),je={class:"file-input-text"},Ee=e("i",{class:"pi pi-upload"},null,-1),Me={class:"flex-1"},qe=e("h3",{style:{margin:"0"}},"اسم العميل",-1),Qe={key:1},Ge={style:{margin:"0",display:"inline"}},He=e("h3",{style:{margin:"0"}},"اسم الباقة",-1),Je={key:3},Ke={style:{margin:"0",display:"inline"}},We={style:{"height-min":"450px"}},Xe={class:"justify-content-between"},Ye={class:"block text-center text-3xl font-bold"},Ze={class:"text-center mb-3"},et={class:"text-center font-semibold text-4xl"},tt=e("span",{class:"text-xs mr-1 text-blue-800"},"د.ل",-1),st=e("p",{class:"font-bold"},"خواص هذه الباقة :",-1),ot={style:{direction:"ltr"},class:"text-center font-bold text-sm"},nt=e("i",{class:"text-green-600 fa-solid fa-circle-check mr-2"},null,-1),it=e("span",{class:"font-medium"},null,-1),at={class:"text-center font-semibold text-sm"},lt=e("i",{class:"text-green-600 fa-solid fa-circle-check mr-2"},null,-1),ct=e("span",{class:"font-medium"},null,-1),rt={style:{direction:"ltr"},class:"text-center font-bold text-sm"},dt=e("i",{class:"text-green-600 fa-solid fa-circle-check mr-1"},null,-1),ut=e("span",{class:"text-green-500 font-medium"},null,-1),_t=e("h4",{style:{margin:"0"}},"عدد الزيارات المتبقية بالساعة",-1),vt=e("h4",{style:{margin:"0","margin-bottom":"2rem"}},"عقد الاشتراك :",-1),mt={class:"field col-4 md:col-4 lg:col-6"},pt={class:""},ft=e("label",{for:"secondaryPhone"},"اسم الملف",-1),ht={class:"file-actions field col-4 md:col-4 lg:col-6"},gt=e("div",{class:"card"},null,-1),Ct=j({__name:"SubscriptionsDetails",setup($){const c=f(!1),u=f(!1),k=f(!1),h=f(),p=f(!1),_=f(),v=re(),w=se(),g=oe(),s=ne({id:"",status:0,serviceName:"",customerName:"",startDate:"",endDate:"",subscriptionFileId:null,daysRemaining:0,monthlyVisits:0,visits:[],file:[{createdOn:"",fileType:0,isActive:!0,id:""}],totalPrice:0,createdOn:""}),P=ie(()=>g&&g.params&&g.params.id?String(g.params.id):"");E(async()=>{S()});function S(){c.value=!0,V.getById(P.value).then(function(a){const t=a.data.content;s.id=t.id,s.status=t.status,s.customerName=t.customerName,s.endDate=t.endDate,s.startDate=t.startDate,s.serviceName=t.serviceName,s.file=t.files,s.createdOn=t.createdOn,s.totalPrice=t.totalPrice,s.daysRemaining=A(t.endDate).diff(A(),"days")}).then(function(){de.get().then(function(a){_.value=a.data.content.find(t=>t.name===s.serviceName)}),I()}).finally(()=>{c.value=!1})}function I(){c.value=!0,ue.get(P.value,s.id).then(function(a){s.visits=a.data.content}).catch(function(a){console.log(a)}).finally(()=>{c.value=!1})}async function M(a){const t=a.target.files[0];h.value=t}const q=()=>{u.value=!0;const a=new FormData;a.append("file",h.value),V.renew(s.id,a).then(t=>{u.value=!1,w.add({severity:"success",summary:"تم التجديد",detail:t,life:3e3}),p.value=!1,ce.go(-1),v.getSubs()}).catch(function(t){w.add({severity:"error",summary:t.response.data.msg||"حدثة مشكلة",detail:t,life:3e3}),u.value=!1}).finally(()=>{u.value=!1})};function Q(){k.value=!k.value}const G=async(a,t)=>{try{const r=await V.getFile(a,t);if(r){const C=new Blob([r.data.content],{type:"application/octet-stream"}),m=URL.createObjectURL(C),y=document.createElement("a");y.href=m,y.download="downloaded_file.png",document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(m)}else console.error("Invalid file response")}catch(r){console.error("Error downloading file:",r),w.add({severity:"error",summary:"خطأ",detail:"حدث خطأ أثناء تحميل الملف",life:3e3})}};return(a,t)=>{const r=b("Divider"),C=b("Skeleton"),m=b("Button"),y=b("Dialog"),H=b("RouterLink"),J=b("ProgressBar"),K=b("InputText"),W=b("card"),X=ae("tooltip");return n(),D(W,null,{title:x(()=>[R(" بيانات الاشتراك "),i(Y,{style:{float:"left"}}),i(r)]),content:x(()=>[s.status==2?(n(),l("div",fe,ge)):B("",!0),e("div",ye,[c.value?(n(),l("div",be,[e("div",xe,[(n(),l(T,null,z(4,o=>e("div",{key:o,class:"ml-3 mb-2"},[e("span",null,[i(C,{width:"15rem",height:"20rem"})])])),64))])])):(n(),l("div",ke,[e("div",we,[i(pe,{percentage:s.daysRemaining},null,8,["percentage"])]),e("div",null,[Ce,s.daysRemaining<30&&s.daysRemaining!==0&&s.daysRemaining>0?(n(),l("div",De,[Re,s.status!==2?(n(),l("div",Pe,[Se,i(m,{icon:"fa-solid fa-repeat",severity:"danger",text:"",rounded:"","aria-label":"Cancel",onClick:t[0]||(t[0]=o=>p.value=!0)})])):B("",!0)])):s.daysRemaining<=0&&s.status!==2?(n(),l("div",Ne,[Be,Ie,i(m,{icon:"fa-solid fa-repeat",severity:"danger",text:"",rounded:"","aria-label":"Cancel",onClick:t[1]||(t[1]=o=>p.value=!0)})])):s.daysRemaining<=0&&s.status!==2?(n(),l("div",Fe,[Ve,$e,i(m,{icon:"fa-solid fa-repeat",severity:"danger",text:"",rounded:"","aria-label":"Cancel",onClick:t[2]||(t[2]=o=>p.value=!0)})])):B("",!0)]),i(y,{visible:p.value,"onUpdate:visible":t[5]||(t[5]=o=>p.value=o),style:{width:"450px",height:"auto",overflow:"hidden"},header:"تجديد الاشتراك",modal:!0},{footer:x(()=>[i(m,{label:"نعم",icon:"pi pi-check",loading:u.value,text:"",onClick:q},null,8,["loading"]),i(m,{label:"لا",icon:"pi pi-times",text:"",onClick:t[4]||(t[4]=o=>p.value=!1)})]),default:x(()=>[Oe,e("div",Le,[e("div",Ue,[e("label",Ae,[e("div",Te,[ze,e("div",je,[Ee,R(" "+d(h.value?h.value.name:"ارفق ملف 1"),1)])]),e("input",{id:"fileInput",style:{display:"none"},type:"file",onChange:t[3]||(t[3]=o=>M(o)),accept:"*"},null,32)])])])]),_:1},8,["visible"])])),i(r,{class:"p-divider-solid",layout:"vertical"}),e("div",Me,[qe,c.value?(n(),D(C,{key:0,width:"100%",height:"1rem"})):(n(),l("span",Qe,[e("p",Ge,d(s.customerName),1),(n(),D(H,{key:s.customerName,to:"/subscriptionsRecord/SubscriptionsDetaView/1",style:{"text-decoration":"none"}}))])),i(r,{class:"p-divider-solid",layout:"horizontal"}),He,c.value?(n(),D(C,{key:2,width:"50%",height:"1rem"})):(n(),l("span",Je,[e("p",Ke,d(s.serviceName),1),le(i(m,{onClick:Q,icon:"fa-solid fa-circle-info",severity:"info",text:"",rounded:"",style:{display:"flex",float:"left",width:"2rem",height:"1rem"}},null,512),[[X,{value:"التفاصيل",fitContent:!0}]]),i(y,{visible:k.value,"onUpdate:visible":t[6]||(t[6]=o=>k.value=o),modal:!0},{default:x(()=>{var o,N,F,O,L,U;return[e("div",We,[e("div",Xe,[e("div",null,[e("span",Ye,d((o=_.value)==null?void 0:o.name),1),e("div",Ze," عدد الزيارات المتاحة في هذه الباقة في الشهر : "+d((N=_.value)==null?void 0:N.monthlyVisits),1),e("div",et,[R(d((F=_.value)==null?void 0:F.price),1),tt])]),i(r)]),st,e("div",ot,[nt,e("span",null,"(Acp Port): "+d((O=_.value)==null?void 0:O.acpPort),1),it]),e("div",at,[e("span",null,"DNS : "+d((L=_.value)==null?void 0:L.dns),1),lt,ct]),e("div",rt,[dt,e("span",null," (Amount Of Power) : "+d((U=_.value)==null?void 0:U.amountOfPower),1),ut])])]}),_:1},8,["visible"])])),i(r,{class:"p-divider-solid",layout:"horizontal"}),_t,c.value?(n(),D(C,{key:4,width:"50%",height:"1rem"})):(n(),D(J,{key:5,class:"mt-2",value:20},{default:x(()=>{var o;return[R(d((o=_.value)==null?void 0:o.monthlyVisits),1)]}),_:1})),i(r,{class:"p-divider-solid",layout:"horizontal"}),vt,c.value?(n(),D(C,{key:6,width:"50%",height:"1rem"})):B("",!0),(n(!0),l(T,null,z(s.file,(o,N)=>(n(),l("div",{key:N,class:"grid p-fluid align-items-center"},[e("div",mt,[e("span",pt,[ft,i(K,{class:"p-inputtext p-component",value:o.id,disabled:!0},null,8,["value"])])]),e("div",ht,[i(m,{onClick:F=>G(s.id,o.id),icon:"fa-solid fa-download",class:"p-button-text p-button-info"},{default:x(()=>[R(" تحميل ")]),_:2},1032,["onClick"])])]))),128))])])]),footer:x(()=>[gt]),_:1})}}});export{Ct as default};
