import{d as X,u as Y,g as l,s as Z,h as ee,r as i,i as te,c as f,b as s,w as n,j as T,F as C,L as R,o as c,k as ae,a as o,m as L,n as N,t as V,N as se,q as oe}from"./index-8a7c54d3.js";import{u as ne}from"./customers-533e8710.js";import{_ as le}from"./AddButton.vue_vue_type_script_setup_true_lang-1faad7b7.js";import{_ as ie}from"./LockButton.vue_vue_type_style_index_0_lang-d0e7d944.js";import{c as g}from"./customers-69672a1b.js";import{_ as re}from"./DeleteButton.vue_vue_type_script_setup_true_lang-33d37ec2.js";const de={key:0},ue={key:0,class:"border-round border-1 surface-border p-4 surface-card"},ce={class:"grid p-fluid"},me={class:"field col-12 md:col-6 lg:col-4"},fe={class:"p-float-label"},pe={class:"flex justify-content-between mt-3"},_e={class:"p-paginator-pages"},ve={class:"grid p-fluid mt-1"},ge={class:"field col-12 md:col-6 lg:col-4"},he={class:"table-header flex flex-column md:flex-row justiify-content-between"},ye={class:"p-input-icon-left p-float-label"},be=o("i",{class:"fa-solid fa-magnifying-glass"},null,-1),we=o("label",{for:"search",style:{"font-weight":"lighter"}}," البحث ",-1),Ce=o("div",{class:"no-data-message",style:{height:"100px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",padding:"20px","background-color":"#f9f9f9","border-radius":"5px","box-shadow":"0 2px 4px rgba(0, 0, 0, 0.1)"}},[o("p",{style:{"font-size":"18px","font-weight":"bold",color:"#888"}}," لا يوجد بيانات ")],-1),ke={key:0},Me=X({__name:"CustomersRecord",setup(xe){const _=Y(),k=l(),m=l(!0),p=l(1),h=l(1),M=l(10),r=l(0),d=l("");ne();const x=Z({global:{value:"",matchMode:R.CONTAINS},status:{value:"",matchMode:R.EQUALS}}),B=l([{field:"email",header:"البريد الإكتروني"},{field:"primaryPhone",header:"رقم الهاتف"},{field:"address",header:"العنوان"}]),F=l(B.value),P=l([{value:1,label:"نشط"},{value:2,label:"مقيد"}]),z=e=>{switch(D(e)){case"نشط":return"success";case"مقيد":return"danger"}},D=e=>{if(e=="1")return"نشط";if(e=="2")return"مقيد"},j=e=>{const a=P.value.find(y=>y.value===e);return a?a.label:""};ee(async()=>{u()});async function I(e){console.log("hi"),d.value=e,await u()}async function u(){console.log("getCustomers method called from child"),(d.value===void 0||d.value===null)&&(d.value=""),await g.get(h.value,M.value,d.value).then(function(e){k.value=e.data.content,p.value=e.data.totalPages,r.value=e.data.currentPage}).catch(function(e){console.log(e)}).finally(()=>{m.value=!1})}const K=async e=>{try{let a;e.status===1?(a=await g.block(e.id),e.status=2):e.status===2&&(a=await g.unblock(e.id),e.status=1),_.add({severity:"success",summary:"نجحة العملية",detail:a==null?void 0:a.data.msg,life:3e3})}catch(a){_.add({severity:"error",summary:"حدث خطأ",detail:a.response.data.msg||"حدث خطأ",life:3e3})}finally{u()}},$=e=>{m.value=!0,g.remove(e).then(a=>{_.add({severity:"success",summary:"تم الحذف",detail:a.data.msg,life:3e3}),u()}).catch(a=>{_.add({severity:"error",summary:"رسالة خطأ",detail:a.response.data.msg,life:3e3})}).finally(()=>{m.value=!1})},A=()=>{r<p&&(r.value+=1,h.value+=1,m.value=!0,u())},E=()=>{r.value>1&&(r.value-=1,h.value-=1,m.value=!0,u())},U=e=>{e.key==="Enter"&&I(d.value)};return(e,a)=>{const y=i("RouterView"),b=i("Skeleton"),w=i("Button"),G=i("InputText"),v=i("Column"),O=i("Tag"),q=i("RouterLink"),Q=i("Toast"),H=i("DataTable"),J=i("Card"),W=te("tooltip");return c(),f(C,null,[s(y),e.$route.path==="/customersRecord"?(c(),f("div",de,[s(J,null,{title:n(()=>[ae(" سجل العملاء "),s(le,{onGetCustomers:u,"name-button":"اضافة عميل","rout-name":"/customersRecord/addCustomer"})]),content:n(()=>[o("div",null,[m.value?(c(),f("div",ue,[o("div",ce,[(c(),f(C,null,L(9,t=>o("div",me,[o("span",fe,[s(b,{width:"100%",height:"2rem"})])])),64))]),s(b,{width:"100%",height:"100px"}),o("div",pe,[s(b,{width:"100%",height:"2rem"})])])):(c(),N(H,{key:1,ref:"dt",value:k.value,dataKey:"id",paginator:!0,rows:10,filters:x,"onUpdate:filters":a[1]||(a[1]=t=>x=t),globalFilterFields:["name","status"],rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"  عرض {first} الى {last} من {totalRecords} عميل",pageLinkSize:p.value,currentPage:r.value-1,paginatorTemplate:"  "},{paginatorstart:n(()=>[s(w,{icon:"pi pi-angle-right",class:"p-button-rounded p-button-primary p-paginator-element",disabled:r.value===1,onClick:E},null,8,["disabled"]),o("span",_e," الصفحة "+V(r.value)+" من "+V(p.value),1)]),paginatorend:n(()=>[s(w,{icon:"pi pi-angle-left",class:"p-button-rounded p-button-primary p-paginator-element",disabled:r.value===p.value,onClick:A},null,8,["disabled"])]),header:n(()=>[o("div",ve,[o("div",ge,[o("div",he,[o("span",ye,[be,s(G,{ref:"searchInput",modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),placeholder:"البحث",onKeydown:se(U,["enter"])},null,8,["modelValue","onKeydown"]),we])])])])]),empty:n(()=>[Ce]),default:n(()=>[s(v,{field:"name",header:"الإسم",style:{"min-width":"6rem"},class:"font-bold",frozen:""}),s(v,{field:"status",header:"  الحاله ",filterField:"status",style:{width:"6rem"},showFilterMenu:!1,filterMenuStyle:{width:"4rem"}},{body:n(({data:t})=>[s(O,{value:j(t.status),severity:z(t.status)},null,8,["value","severity"])]),filter:n(({filterModel:t,filterCallback:S})=>[]),_:1}),(c(!0),f(C,null,L(F.value,(t,S)=>(c(),N(v,{field:t.field,header:t.header,key:t.field+"_"+S,style:{"min-width":"6rem"}},null,8,["field","header"]))),128)),s(v,{style:{"min-width":"11rem"},header:"  الاجراءات "},{body:n(t=>[t.data.status!==2?(c(),f("span",ke,[s(re,{name:t.data.name,id:t.data.id,onSubmit:()=>$(t.data.id),type:"Customers"},null,8,["name","id","onSubmit"])])):T("",!0),s(q,{to:"customersRecord/CustomerProfile/"+t.data.id},{default:n(()=>[oe(s(w,{icon:"fa-solid fa-user",severity:"info",text:"",rounded:"","aria-label":"Cancel"},null,512),[[W,{value:"البيانات الشخصية",fitContent:!0}]])]),_:2},1032,["to"]),s(ie,{typeLock:"Customers",id:t.data.id,name:t.data.name,status:t.data.status,onGetdata:u,onSubmit:()=>K(t.data)},null,8,["id","name","status","onSubmit"])]),_:1}),s(Q,{position:"bottom-left"})]),_:1},8,["value","filters","pageLinkSize","currentPage"]))])]),_:1})])):T("",!0)],64)}}});export{Me as default};
